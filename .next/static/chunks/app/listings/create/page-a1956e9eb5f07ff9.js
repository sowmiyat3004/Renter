(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[171],{6027:function(e,t,s){Promise.resolve().then(s.bind(s,2776))},2776:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return N}});var a=s(7437),i=s(2265),r=s(605),l=s(9376),n=s(9501),c=s(3590),o=s(1384),d=s(9064),m=s(9205);let u=(0,m.Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var h=s(1128),x=s(3299);let p=(0,m.Z)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),g=(0,m.Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var y=s(7648),b=s(8786);function f(e,t){return new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:2,...t}).format(e)}function j(e){let{label:t,value:s,onChange:r,id:l,name:n,placeholder:c,disabled:o=!1,required:d=!1}=e,[m,u]=(0,i.useState)("");return(0,i.useEffect)(()=>{null!=s?u(f(s)):u("")},[s]),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:l||n,className:"block text-sm font-medium leading-6 text-gray-900",children:t}),(0,a.jsxs)("div",{className:"relative mt-2 rounded-md shadow-sm",children:[(0,a.jsx)("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:(0,a.jsx)("span",{className:"text-gray-500 sm:text-sm",children:"₹"})}),(0,a.jsx)("input",{type:"text",id:l||n,name:n,className:"block w-full rounded-md border-0 py-1.5 pl-7 pr-12 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6",placeholder:c||"0.00",value:m,onChange:e=>{let t=e.target.value;u(t);let s=parseFloat(t.replace(/₹|,/g,"").trim());isNaN(s)?r(void 0):r(s)},onBlur:()=>{null!=s?u(f(s)):u("")},disabled:o,required:d}),(0,a.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3",children:(0,a.jsx)("span",{className:"text-gray-500 sm:text-sm",id:"price-currency",children:"INR"})})]})]})}function N(){let{data:e,status:t}=(0,r.useSession)(),s=(0,l.useRouter)(),[m,f]=(0,i.useState)(!1),[N,v]=(0,i.useState)([]),[w,S]=(0,i.useState)([]),[k,Z]=(0,i.useState)([]),{register:R,handleSubmit:D,formState:{errors:C},setValue:_,watch:E}=(0,n.cI)({resolver:(0,c.F)(o.TH)});(0,i.useEffect)(()=>{if("loading"!==t){if(!e){s.push("/auth/signin");return}F()}},[e,t,s]);let F=async()=>{try{let e=await fetch("/api/amenities"),t=await e.json();t.success&&S(t.data)}catch(e){console.error("Error fetching amenities:",e)}},P=e=>{v(t=>t.filter((t,s)=>s!==e))},A=e=>{Z(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},I=async e=>{if(0===N.length){d.Am.error("Please upload at least one image");return}f(!0);try{let t=new FormData;t.append("title",e.title),t.append("description",e.description),t.append("priceAmount",e.priceAmount.toString()),t.append("bedrooms",e.bedrooms.toString()),t.append("bathrooms",e.bathrooms.toString()),t.append("state",e.state),t.append("city",e.city),t.append("lat",e.lat.toString()),t.append("lng",e.lng.toString()),t.append("amenities",JSON.stringify(k)),N.forEach((e,s)=>{t.append("images",e)});let a=await fetch("/api/listings",{method:"POST",body:t}),i=await a.json();i.success?(d.Am.success("Listing created successfully! It will be reviewed by our admin team."),s.push("/dashboard")):d.Am.error(i.error||"Failed to create listing")}catch(e){d.Am.error("Something went wrong. Please try again.")}finally{f(!1)}};return"loading"===t?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsx)("div",{className:"spinner h-8 w-8"})}):(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)(y.default,{href:"/dashboard",className:"inline-flex items-center text-gray-600 hover:text-gray-900 mb-4",children:[(0,a.jsx)(u,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Create New Listing"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Fill in the details below to list your property"})]}),(0,a.jsxs)("form",{onSubmit:D(I),className:"space-y-8",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Basic Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Property Title *"}),(0,a.jsx)("input",{...R("title"),type:"text",className:"input ".concat(C.title?"input-error":""),placeholder:"e.g., Beautiful 2-bedroom apartment in downtown"}),C.title&&(0,a.jsx)("p",{className:"form-error",children:String(C.title.message)})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),(0,a.jsx)("textarea",{...R("description"),rows:4,className:"input ".concat(C.description?"input-error":""),placeholder:"Describe your property, its features, and what makes it special..."}),C.description&&(0,a.jsx)("p",{className:"form-error",children:String(C.description.message)})]}),(0,a.jsx)(j,{label:"Monthly Rent *",value:E("priceAmount"),onChange:e=>_("priceAmount",e||0),placeholder:"0",required:!0}),C.priceAmount&&(0,a.jsx)("p",{className:"form-error",children:String(C.priceAmount.message)}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bedrooms *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(h.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,a.jsxs)("select",{...R("bedrooms",{valueAsNumber:!0}),className:"input pl-10 ".concat(C.bedrooms?"input-error":""),children:[(0,a.jsx)("option",{value:"",children:"Select bedrooms"}),(0,a.jsx)("option",{value:0,children:"Studio"}),(0,a.jsx)("option",{value:1,children:"1"}),(0,a.jsx)("option",{value:2,children:"2"}),(0,a.jsx)("option",{value:3,children:"3"}),(0,a.jsx)("option",{value:4,children:"4"}),(0,a.jsx)("option",{value:5,children:"5+"})]})]}),C.bedrooms&&(0,a.jsx)("p",{className:"form-error",children:String(C.bedrooms.message)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bathrooms *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(x.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,a.jsxs)("select",{...R("bathrooms",{valueAsNumber:!0}),className:"input pl-10 ".concat(C.bathrooms?"input-error":""),children:[(0,a.jsx)("option",{value:"",children:"Select bathrooms"}),(0,a.jsx)("option",{value:1,children:"1"}),(0,a.jsx)("option",{value:1.5,children:"1.5"}),(0,a.jsx)("option",{value:2,children:"2"}),(0,a.jsx)("option",{value:2.5,children:"2.5"}),(0,a.jsx)("option",{value:3,children:"3"}),(0,a.jsx)("option",{value:3.5,children:"3.5"}),(0,a.jsx)("option",{value:4,children:"4+"})]})]}),C.bathrooms&&(0,a.jsx)("p",{className:"form-error",children:String(C.bathrooms.message)})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Amenities"}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:w.map(e=>(0,a.jsxs)("label",{className:"flex items-center space-x-3 cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",value:e.id,checked:k.includes(e.id),onChange:t=>{t.target.checked?Z([...k,e.id]):Z(k.filter(t=>t!==e.id))},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,a.jsx)("span",{className:"text-sm text-gray-700",children:e.name})]},e.id))})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Location"}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(b.V,{label:"Location *",value:E("location"),onChange:e=>{e&&(_("city",e.name),_("state",e.state),_("lat",e.lat||0),_("lng",e.lng||0))},placeholder:"Search for city, district, or state",className:"w-full"}),(C.city||C.state)&&(0,a.jsx)("p",{className:"form-error",children:"Please select a valid location"}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address (Optional)"}),(0,a.jsx)("input",{type:"text",className:"input",placeholder:"Enter full address for better location accuracy"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"This will help renters find your property more easily"})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Property Photos"}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload Images * (Max 1MB each)"}),(0,a.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors",children:[(0,a.jsx)(p,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:"Drag and drop images here, or click to select"}),(0,a.jsx)("input",{type:"file",multiple:!0,accept:"image/*",onChange:e=>{let t=Array.from(e.target.files||[]).filter(e=>!(e.size>1048576)||(d.Am.error("".concat(e.name," is too large. Maximum size is 1MB.")),!1));v(e=>[...e,...t])},className:"hidden",id:"image-upload"}),(0,a.jsx)("label",{htmlFor:"image-upload",className:"btn-secondary cursor-pointer",children:"Choose Images"})]})]}),N.length>0&&(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:N.map((e,t)=>(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("img",{src:URL.createObjectURL(e),alt:"Upload ".concat(t+1),className:"w-full h-24 object-cover rounded-lg"}),(0,a.jsx)("button",{type:"button",onClick:()=>P(t),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600",children:(0,a.jsx)(g,{className:"h-4 w-4"})})]},t))})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Amenities"}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:w.map(e=>(0,a.jsxs)("label",{className:"flex items-center space-x-3 cursor-pointer hover:bg-gray-50 p-3 rounded-lg border border-gray-200",children:[(0,a.jsx)("input",{type:"checkbox",checked:k.includes(e.id),onChange:()=>A(e.id),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),(0,a.jsx)("span",{className:"text-sm text-gray-700",children:e.name})]},e.id))})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,a.jsx)(y.default,{href:"/dashboard",className:"btn-secondary",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:m,className:"btn-primary",children:m?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"spinner h-4 w-4 mr-2"}),"Creating Listing..."]}):"Create Listing"})]})]})]})})}},8786:function(e,t,s){"use strict";s.d(t,{V:function(){return o}});var a=s(7437),i=s(2265),r=s(2975),l=s(9829),n=s(5249),c=s(1994);function o(e){let{label:t,value:s,onChange:o,placeholder:d="Search for location...",className:m="",showAllTypes:u=!0,debounceMs:h=300}=e,[x,p]=(0,i.useState)(""),[g,y]=(0,i.useState)([]),[b,f]=(0,i.useState)(!1),[j,N]=(0,i.useState)(!1),v=(0,i.useRef)(null),w=(0,i.useRef)();(0,i.useEffect)(()=>{if(x.length<2){y([]);return}return w.current&&clearTimeout(w.current),w.current=setTimeout(async()=>{await S(x)},h),()=>{w.current&&clearTimeout(w.current)}},[x,h]);let S=async e=>{f(!0);try{let t=await fetch("/api/locations?type=comprehensive&q=".concat(encodeURIComponent(e),"&limit=20")),s=await t.json();if(s.success){let e=[];s.data.states&&s.data.states.forEach(t=>{e.push({id:"state-".concat(t.name),type:"state",name:t.name,displayName:t.name})}),s.data.districts&&s.data.districts.forEach(t=>{e.push({id:"district-".concat(t.state,"-").concat(t.district),type:"district",name:t.district,state:t.state,displayName:"".concat(t.district,", ").concat(t.state)})}),s.data.cities&&s.data.cities.forEach(t=>{e.push({id:"city-".concat(t.state,"-").concat(t.city),type:"city",name:t.city,state:t.state,district:t.district,lat:t.lat,lng:t.lng,displayName:t.district?"".concat(t.city,", ").concat(t.district,", ").concat(t.state):"".concat(t.city,", ").concat(t.state)})}),s.data.localities&&s.data.localities.forEach(t=>{e.push({id:"locality-".concat(t.state,"-").concat(t.city,"-").concat(t.locality),type:"locality",name:t.locality,state:t.state,district:t.district,city:t.city,locality:t.locality,lat:t.lat,lng:t.lng,displayName:t.district?"".concat(t.locality,", ").concat(t.city,", ").concat(t.district,", ").concat(t.state):"".concat(t.locality,", ").concat(t.city,", ").concat(t.state)})}),y(e)}}catch(e){console.error("Error fetching locations:",e),y([])}finally{f(!1)}},k=e=>{p(e),N(!0),!e&&e&&o(null)},Z=e=>{switch(e){case"state":return"\uD83C\uDFDB️";case"district":return"\uD83C\uDFD8️";case"city":return"\uD83C\uDFD9️";case"locality":return"\uD83C\uDFE0";default:return"\uD83D\uDCCD"}},R=e=>{switch(e){case"state":return"State";case"district":return"District";case"city":return"City";case"locality":return"Locality";default:return"Location"}};return(0,a.jsx)("div",{className:"relative ".concat(m),children:(0,a.jsxs)(n.h,{as:"div",value:s,onChange:e=>{o(e),e?p(e.displayName):p(""),N(!1)},children:[(0,a.jsx)(n.h.Label,{className:"block text-sm font-medium leading-6 text-gray-900 mb-2",children:t}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(n.h.Input,{className:"w-full rounded-md border-0 bg-white py-2 pl-10 pr-10 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6",onChange:e=>k(e.target.value),onFocus:()=>{N(!0)},onBlur:()=>{setTimeout(()=>N(!1),200)},displayValue:e=>e?e.displayName:"",placeholder:d,ref:v}),(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3",children:(0,a.jsx)(r.Z,{className:"h-5 w-5 text-gray-400"})}),(0,a.jsx)(n.h.Button,{className:"absolute inset-y-0 right-0 flex items-center rounded-r-md px-2 focus:outline-none",children:(0,a.jsx)(l.Z,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})})]}),j&&(0,a.jsxs)(n.h.Options,{className:"absolute z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm",children:[b&&(0,a.jsx)("div",{className:"relative cursor-default select-none py-2 pl-3 pr-9 text-gray-500",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-indigo-600 mr-2"}),"Searching locations..."]})}),!b&&0===g.length&&x.length>=2&&(0,a.jsx)("div",{className:"relative cursor-default select-none py-2 pl-3 pr-9 text-gray-500",children:"No locations found."}),!b&&g.length>0&&(0,a.jsx)(a.Fragment,{children:g.map(e=>(0,a.jsx)(n.h.Option,{value:e,className:e=>{let{active:t}=e;return(0,c.Z)("relative cursor-default select-none py-2 pl-3 pr-9",t?"bg-indigo-600 text-white":"text-gray-900")},children:t=>{let{active:s,selected:i}=t;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-lg mr-2",children:Z(e.type)}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("span",{className:(0,c.Z)("block truncate",i&&"font-semibold"),children:e.displayName}),(0,a.jsxs)("span",{className:(0,c.Z)("block text-xs",s?"text-indigo-200":"text-gray-500"),children:[R(e.type),e.lat&&e.lng&&(0,a.jsxs)("span",{className:"ml-2",children:["\uD83D\uDCCD ",e.lat.toFixed(4),", ",e.lng.toFixed(4)]})]})]})]}),i&&(0,a.jsx)("span",{className:(0,c.Z)("absolute inset-y-0 right-0 flex items-center pr-4",s?"text-white":"text-indigo-600"),children:"✓"})]})}},e.id))})]})]})]})})}},1384:function(e,t,s){"use strict";s.d(t,{JJ:function(){return i},TH:function(){return l},wL:function(){return r}});var a=s(7119);let i=a.Ry({name:a.Z_().min(2,"Name must be at least 2 characters"),email:a.Z_().email("Invalid email address"),password:a.Z_().min(8,"Password must be at least 8 characters"),confirmPassword:a.Z_()}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),r=a.Ry({email:a.Z_().email("Invalid email address"),password:a.Z_().min(1,"Password is required")}),l=a.Ry({title:a.Z_().min(5,"Title must be at least 5 characters"),description:a.Z_().min(20,"Description must be at least 20 characters"),priceAmount:a.Rx().min(0,"Price must be positive"),bedrooms:a.Rx().min(0,"Bedrooms must be 0 or more"),bathrooms:a.Rx().min(0,"Bathrooms must be 0 or more"),state:a.Z_().min(1,"State is required"),district:a.Z_().optional(),city:a.Z_().min(1,"City is required"),locality:a.Z_().optional(),address:a.Z_().optional(),lat:a.Rx().min(-90).max(90),lng:a.Rx().min(-180).max(180),amenities:a.IX(a.Z_()).optional()});l.partial().extend({id:a.Z_()}),a.Ry({minPrice:a.Rx().optional(),maxPrice:a.Rx().optional(),bedrooms:a.Rx().optional(),bathrooms:a.Rx().optional(),amenities:a.IX(a.Z_()).optional(),lat:a.Rx().optional(),lng:a.Rx().optional(),radius:a.Rx().optional(),page:a.Rx().min(1).default(1),limit:a.Rx().min(1).max(50).default(12)}),a.Ry({listingId:a.Z_(),actionType:a.Km(["APPROVE","REJECT","SUSPEND","DELETE"]),reason:a.Z_().optional()}),a.Ry({name:a.Z_().min(2,"Name must be at least 2 characters"),email:a.Z_().email("Invalid email address"),message:a.Z_().min(10,"Message must be at least 10 characters"),listingId:a.Z_()})}},function(e){e.O(0,[448,605,701,64,598,683,971,117,744],function(){return e(e.s=6027)}),_N_E=e.O()}]);